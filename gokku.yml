# Gokku Deployment Configuration
# This file defines your applications and environments

project:
  name: gokku
  base_dir: /opt/gokku

apps:
  - name: speech-to-text
    build:
      path: ./cmd/speech-to-text
      binary_name: speech-to-text
      work_dir: apps/trunk
      go_version: "1.25"
    deployment:
      keep_releases: 5
      restart_policy: always
      restart_delay: 5

  - name: voice-agent
    build:
      path: ./cmd/voice-agent
      binary_name: voice-agent
      work_dir: apps/trunk
      go_version: "1.25"
    ports:
      - "5064:5064"
    network:
      mode: host
    deployment:
      keep_releases: 5
      restart_policy: always
      restart_delay: 5

  - name: vad
    lang: python
    build:
      path: ./apps/vad
      dockerfile: ./apps/vad/Dockerfile  # optional, will generate if not exists
      entrypoint: main.py
      image: "python:3.11-slim"  # Base image for local build
    deployment:
      keep_releases: 3
      keep_images: 5
      restart_policy: always
      restart_delay: 10

  # Example of pre-built image from registry (ultra-fast deployment)
  - name: api-prebuilt
    build:
      image: "ghcr.io/meu-org/api:latest"  # Pre-built image from registry
    deployment:
      keep_releases: 3
      restart_policy: always
      restart_delay: 5

# Port assignment strategy: auto or manual
# auto: automatically assigns sequential ports starting from base_port
# manual: use ports defined in .env for each app/environment
port_strategy: manual

# Custom registries for pre-built images
docker:
  registry:  # Custom registries for pre-built images
    - "self-ghrc.io"  # Your own GitHub Container Registry
    - "registry.company.com"  # Company private registry
    - "harbor.example.com"  # Harbor registry
